Database Schema Design

1. Users Collection
   Fields:
   _id : String (Unique Identifier)
   userId: String
   name: String
   email: String (Unique Identifier)
   phoneNumber: String (Unique Identifier)

2. Books Collection
   Fields:
   _id : String (Unique Identifier)
   bookId: String (Unique Identifier)
   bookName: String
   category: String
   rentPerDay: Number

3. Transactions Collection
   Fields:
   _id: String (Unique Identifier)
   bookId: String (Reference to Books)
   userId: String (Reference to Users)
   issueDate: Date
   returnDate: Date (Nullable)
   totalRent: Number (Computed field after return)

API Design

4. Search for Books by Name or Term
   Endpoint: GET /books/{bookName}/search
   Input: bookName or a term
   Output: List of books that match the name or term.

5. Search for Books by Rent Range
   Endpoint: GET /books/rent?minRent={}&maxRent={}
   Input: minRent, maxRent
   Output: List of books with rent in the specified range.

6. Search by Category + Name/Term + Rent Range
   Endpoint: GET /books/search/advanced (raw JSON)
   Input: category, bookName, minRent, maxRent
   Output: List of books matching the criteria.

7. Issue a Book
   Endpoint: POST /transactions/issue
   Input: bookId, userId, issueDate (raw JSON)
   Output: Update the Transaction DB with these values.

8. Return a Book
   Endpoint: patch /transactions/return
   Input: bookId, userId, returnDate
   Output: Calculate rent and update the Transaction DB.

API for Transaction Queries

9. Get List of Users Who Have Issued a Book
   Endpoint: GET /transactions/book/{bookName}/users
   Input: bookName
   Output: List of users who have issued the book in the past and current status.

10. Get Total Rent Generated by a Book
    Endpoint: GET /transactions/book/{bookId}/rent
    Input: bookId
    Output: Total rent generated by that book.

11. Get Books Issued to a User
    Endpoint: GET /transactions/user/{userId}/books
    Input: userId
    Output: List of books issued to the user.

12. Get Books Issued in a Date Range
    Endpoint: GET /transactions/date-range?startDate={}&endDate={}
    Input: startDate, endDate
    Output: List of books issued in that date range and the users who issued them.
    
Helper APIs
    Get All Users
    Endpoint: GET /users
    Get All Books
    Endpoint: GET /books
    Get All Transactions
    Endpoint: GET /transactions
